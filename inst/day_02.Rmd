---
title: "R Notebook"
output: html_notebook
---

```{r}
library(rvest)
```

```{r}
input <- \(day = 1, year = 2023) {
  rvest::session('https://adventofcode.com/{year}/day/{day}/input',
                 year = year, day = day)
  rvest::html_elements()
}
# Well, that got a 400, so onwards.
```

TODO:
- Format for game data 
- Reformat to fit game data

What am I to consider an **observation**? -- One round of one game (has features GAME, RED, GREEN, BLUE, ROUND). 

```{r}
games <- readLines(con = here::here('data', 'day_02'))
```

```{r}
names(games) <- 1:100
```
```{r}
games <- stringr::str_remove_all(string = games, pattern = 'Game \\d+: ')
```
```{r}
rounds <- stringr::str_split(string = games, pattern = '; ')
```
```{r}
split_color <- \(round) {
  res <- stringr::str_split(string = round, pattern = ', ')
  res
}
```
```{r}
test_game <- split_color(rounds[[1]])
test_count <- str_extract_all(string = test_game, pattern = '\\d+')
test_color <- str_extract_all(string = test_game, pattern = 'red|blue|green')

# wrapr::named_map_builder(targets = test_color[[]], values = test_count)
test_color[[1]][1]

# as.character(test_color[]) %>% str_replace_all(pattern = 'c|((|))|,', replacement = '')
## mmmyeah no pe 
```

```{r}
name_color <- \(colors, counts) {
#  names(counts) <- colors
#  counts
  wrapr::named_map_builder(targets = colors, values = counts)
}
```

What I need at current format is rounds[[i]][j] (e.g. for Game 1 Round 1 rounds[[1]][1] will render me one list 'red' 'green' 'blue' one list '10' '7' '3')
```{r}
count_color <- \(vec) {
  color_ordered <- stringr::str_extract_all(string = vec, pattern = 'red|blue|green',
                                            simplify = TRUE) 
  count_ordered <- stringr::str_extract_all(string = vec, pattern = '\\d+',
                                            simplify = TRUE) 
#  furrr::future_map2(.x = color_ordered, .y = count_ordered, .f = name_color) 
  ### that works but I don't think it's working in parallel as intended, so...
#  list(colors = color_ordered, counts = count_ordered) ## so THAT works as intended once simplified...
  ### the fuck definition of 'simple' are we using here
#  wrapr::as_named_list(color_ordered, count_ordered)
#  name_color(colors = color_ordered, counts = count_ordered)
  res <- count_ordered
  names(res) <- color_ordered
  res
}
```

No that's sideways. Why can't I figure out how not to give myself things sideways.

Update: well at least it's not-sideways in the wrong way instead of just sideways.


```{r}
test_game <- rounds[[1]]
comp_colors <- stringr::str_extract_all(string = test_game, pattern = 'red|blue|green')
comp_counts <- stringr::str_extract_all(string = test_game, pattern = '\\d+')

test_colors <- comp_colors[[1]]
test_counts <- comp_counts[[1]]
names(test_counts) <- test_colors
test_counts
```
So... *that* works as intended. 

```{r}
count_color2 <- \(vec) {
  color_ordered <- stringr::str_extract_all(string = vec, pattern = 'red|blue|green',
                                            simplify = FALSE) 
  count_ordered <- stringr::str_extract_all(string = vec, pattern = '\\d+',
                                            simplify = FALSE) 
#  furrr::future_map2(.x = color_ordered, .y = count_ordered, .f = name_color) 
  ### that works but I don't think it's working in parallel as intended, so...
#  list(colors = color_ordered, counts = count_ordered) ## so THAT works as intended once simplified...
  ### the fuck definition of 'simple' are we using here
#  wrapr::as_named_list(color_ordered, count_ordered)
#  name_color(colors = color_ordered, counts = count_ordered)
  res <- count_ordered
  names(res) <- color_ordered
  res
}
```
...But **this** doesn't...

So I need to do for loops for now. Gross.

TODO: for loops I **guessss**

also my hand to G-d I could do this more elegantly  with lookaheads and capturing groups if I weren't [insert the usual excuses I am so tired please send help and caffeine it is finals]
